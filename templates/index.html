<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>Nova</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#fff;--bg2:#f5f5f5;--br:#ddd;
  --tx:#222;--tx2:#777;--ac:#4a3fc0;--gn:#1a9;--rd:#d44;--yl:#c90
}
html,body{height:100%;overflow:hidden}
body{font:15px/1.6 "Courier New",Courier,"Lucida Console",monospace;background:var(--bg);color:var(--tx)}

.s{display:none;height:100%;width:100%}.s.on{display:flex}

/* auth */
#A{align-items:center;justify-content:center;text-align:center;background:var(--bg)}
#A h1{font-size:2.4rem;font-weight:800;margin-bottom:.2rem;color:var(--tx)}
#A h1 b{color:var(--ac)}
#A .tag{color:var(--tx2);margin-bottom:1.6rem}
.auth-box{width:300px;margin:0 auto}
.g-wrap{margin-bottom:14px;display:flex;justify-content:center}
.ae{color:var(--rd);font-size:13px;min-height:18px;margin-top:4px}
.shield{margin-top:1.5rem;font-size:11px;color:var(--tx2);opacity:.7;line-height:1.6}
.shield b{color:var(--tx)}
.tos-row{display:flex;align-items:flex-start;gap:8px;margin-top:10px;text-align:left;font-size:12px;color:var(--tx2)}
.tos-row input[type=checkbox]{margin-top:3px;accent-color:var(--ac);cursor:pointer;flex-shrink:0}
.tos-row a{color:var(--ac);text-decoration:underline}

/* lobby */
#L{align-items:center;justify-content:center;text-align:center;background:var(--bg)}
#L h1{font-size:2.4rem;font-weight:800;margin-bottom:.3rem;color:var(--tx)}
#L h1 b{color:var(--ac)}
#L .tag{color:var(--tx2);margin-bottom:1.4rem}
.ob{display:inline-flex;align-items:center;gap:6px;background:#1a91;border:1px solid #1a93;border-radius:99px;padding:4px 14px;font-size:13px;color:var(--gn);margin-bottom:1.4rem}
.ob .d{width:7px;height:7px;border-radius:50%;background:var(--gn)}
.ub{display:flex;align-items:center;justify-content:center;gap:8px;font-size:13px;color:var(--tx2);margin-bottom:1.2rem}
.ub img{width:24px;height:24px;border-radius:50%}
.ub strong{color:var(--tx)}

.b{font:inherit;font-weight:600;font-size:14px;border:none;border-radius:10px;cursor:pointer;padding:8px 18px;display:inline-flex;align-items:center;gap:6px}
.bp{background:var(--ac);color:#fff;font-size:16px;padding:14px 36px;border-radius:14px}
.bp:hover{opacity:.9}
.bl{background:none;color:var(--tx2);font-size:12px;padding:4px 10px;border:1px solid var(--br);border-radius:6px;cursor:pointer}
.bl:hover{background:var(--bg2)}
.sub{margin-top:1rem;font-size:12px;color:var(--tx2);opacity:.6}

/* video chat */
#C{flex-direction:column;background:#000}
.vid-area{flex:1;position:relative;overflow:hidden;background:#000}
#rv{width:100%;height:100%;object-fit:cover;background:#111}
#lv{position:absolute;bottom:16px;right:16px;width:160px;height:120px;border-radius:12px;border:2px solid #fff3;z-index:2;object-fit:cover;background:#222}
.vid-status{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:#fff;z-index:1}
.vid-status button{pointer-events:auto}
.vid-status .vs-text{font-size:18px;font-weight:600;margin-bottom:8px}
.vid-status .vs-sub{font-size:13px;color:#aaa}
.vid-status .spinner{width:40px;height:40px;border:3px solid #333;border-top-color:var(--ac);border-radius:50%;animation:sp .8s linear infinite;margin:0 auto 12px}
@keyframes sp{to{transform:rotate(360deg)}}

/* bottom controls */
.controls{display:flex;align-items:center;justify-content:center;gap:12px;padding:16px;background:var(--bg);flex-shrink:0;border-top:1px solid var(--br)}
.ctrl-btn{width:52px;height:52px;border-radius:50%;border:none;cursor:pointer;font-size:22px;display:flex;align-items:center;justify-content:center;transition:all .15s}
.ctrl-btn.green{background:var(--ac);color:#fff}
.ctrl-btn.green:hover{opacity:.85}
.ctrl-btn.red{background:var(--rd);color:#fff}
.ctrl-btn.red:hover{opacity:.85}
.ctrl-btn.tog{background:var(--bg2);color:var(--tx);border:1px solid var(--br)}
.ctrl-btn.tog:hover{background:#e8e8e8}
.ctrl-btn.tog.off{background:var(--rd);color:#fff;border-color:var(--rd)}
.online-sm{display:flex;align-items:center;gap:5px;font-size:12px;color:#fff;position:absolute;top:12px;right:16px;z-index:3;background:#0008;padding:4px 10px;border-radius:20px;backdrop-filter:blur(4px)}
.online-sm .d{width:6px;height:6px;border-radius:50%;background:var(--gn)}
.logo-sm{position:absolute;top:12px;left:16px;z-index:3;font-weight:700;font-size:14px;color:#fff;background:#0008;padding:4px 12px;border-radius:20px;backdrop-filter:blur(4px)}
.logo-sm b{color:var(--ac)}

/* contact */
.contact{margin-top:1.2rem;font-size:11px;color:var(--tx2);opacity:.6}
.contact a{color:var(--ac);text-decoration:none}
.contact a:hover{text-decoration:underline}

/* ads */
.ad-slot{margin:16px auto;text-align:center;overflow:hidden;max-width:728px;min-height:50px}
.ad-label{font-size:9px;color:var(--tx2);opacity:.4;text-transform:uppercase;letter-spacing:1px;margin-bottom:2px}

@media(max-width:600px){
  #A h1,#L h1{font-size:1.8rem}
  .auth-box{width:260px}
  #lv{width:100px;height:75px;bottom:10px;right:10px}
  .ctrl-btn{width:46px;height:46px;font-size:18px}
  .controls{gap:10px;padding:12px}
  .ad-slot{max-width:320px}
}
</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê Auth Screen ‚ïê‚ïê‚ïê -->
<div id="A" class="s on">
  <div>
    <h1>No<b>va</b></h1>
    <p class="tag">Video chat with strangers</p>
    <div class="auth-box">
      <div class="tos-row" id="tos-row" style="margin-bottom:14px">
        <input type="checkbox" id="tos-cb">
        <label for="tos-cb">I agree to the <a href="/tos" target="_blank">Terms of Service</a></label>
      </div>
      <div class="g-wrap"><div id="g-btn"></div></div>
      <div class="ae" id="a-err"></div>
    </div>
    <div class="shield">
      üõ° <b>Your safety matters.</b><br>
      All connections are logged for legal compliance.<br>
      IP addresses and session data are retained for {{ retention_days }} days.
    </div>
    <div class="contact">Contact: <a href="mailto:rahul@simpleintelligence.com">rahul@simpleintelligence.com</a></div>
    {% if adsense_id %}
    <div class="ad-slot" id="ad-auth">
      <div class="ad-label">Advertisement</div>
      <ins class="adsbygoogle" style="display:block" data-ad-client="{{ adsense_id }}" data-ad-slot="auth-banner" data-ad-format="auto" data-full-width-responsive="true"></ins>
    </div>
    {% endif %}
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê Lobby ‚ïê‚ïê‚ïê -->
<div id="L" class="s">
  <div>
    <h1>No<b>va</b></h1>
    <p class="tag">Video chat with strangers</p>
    <div class="ub">
      <img id="uavatar" src="" alt="" style="display:none">
      <span>Logged in as <strong id="uname"></strong></span>
      <button class="bl" id="logout">log out</button>
    </div>
    <div class="ob"><span class="d"></span><span id="ol">0</span> online</div><br>
    <button class="b bp" id="go">üìπ Start Video Chat</button>
    <p class="sub">Peer-to-peer video ¬∑ Server only matches you</p>
    <div class="contact">Contact: <a href="mailto:rahul@simpleintelligence.com">rahul@simpleintelligence.com</a></div>
    {% if adsense_id %}
    <div class="ad-slot" id="ad-lobby">
      <div class="ad-label">Advertisement</div>
      <ins class="adsbygoogle" style="display:block" data-ad-client="{{ adsense_id }}" data-ad-slot="lobby-banner" data-ad-format="auto" data-full-width-responsive="true"></ins>
    </div>
    {% endif %}
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê Video Chat ‚ïê‚ïê‚ïê -->
<div id="C" class="s">
  <div class="vid-area">
    <div class="logo-sm">No<b>va</b></div>
    <div class="online-sm"><span class="d"></span><span id="oc">0</span> online</div>
    <video id="rv" autoplay playsinline></video>
    <video id="lv" autoplay playsinline muted></video>
    <div class="vid-status" id="vs">
      <div class="spinner"></div>
      <div class="vs-text" id="vs-text">Looking for someone‚Ä¶</div>
      <div class="vs-sub" id="vs-sub">Please allow camera access</div>
    </div>
  </div>
  <div class="controls">
    <button class="ctrl-btn tog" id="cam-tog" title="Toggle camera">üì∑</button>
    <button class="ctrl-btn tog" id="mic-tog" title="Toggle mic">üé§</button>
    <button class="ctrl-btn green" id="sk" title="Next person">‚è≠</button>
    <button class="ctrl-btn red" id="dc" title="Disconnect">‚úï</button>
  </div>
</div>

{% if adsense_id %}
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ adsense_id }}" crossorigin="anonymous"></script>
<script>
  window.addEventListener("load",()=>{
    document.querySelectorAll(".adsbygoogle").forEach(()=>{
      try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){}
    });
  });
</script>
{% endif %}
{% if google_client_id %}
<script src="https://accounts.google.com/gsi/client" async defer></script>
{% endif %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
<script>window.__GOOGLE_CLIENT_ID__="{{ google_client_id }}";</script>
<script src="/static/js/app.js"></script>
</body>
</html>
